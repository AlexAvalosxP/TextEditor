[
  {
    "Id": "893553",
    "ThreadId": "389694",
    "Html": "\r\n<p>Hi, i am struggling with styling a table.</p>\r\n<p>Is there a way to set table background and width (100%) ?</p>\r\n<p>&nbsp;</p>\r\n<p>EDIT: i found the tag for&nbsp;setting background, in styles.inc i added&nbsp;'bgColor' =&gt; '666666', to 'td' field.</p>\r\n<p>But the width problem still remains. how to set table width to fit the page width?</p>\r\n",
    "PostedDate": "2012-07-31T04:39:35.84-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "897412",
    "ThreadId": "389694",
    "Html": "<p>Hi tesiadynamics</p>\r\n<p>You can't currently set the width of the table to fit the page width as this is not a setting that is available in PHPWord (see the PHPWord documentation in&nbsp;PHPWord_Docs_0.6.2.docx - in the phpword directory) - you can only set the widths of individual cells. However, this could be added as a feature to future versions of the HTML to docx converter, probably something like this:</p>\r\n<p>* Add a setting to define a width (in TWIPs or px) for a fully sized table (or we can get this information from the pageSizeW property);</p>\r\n<p>* Pick up percentage widths set by a CSS class or inline style;</p>\r\n<p>* Use the above two to compute the width that each cell needs to be (also taking into account border widths) in order to scale the width of the table correctly.</p>\r\n<p>Feel free to suggest some code (as a patch if possible) and/or add this to the issue tracker.</p>\r\n<p>Neil</p>",
    "PostedDate": "2012-08-09T01:14:56.283-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "897415",
    "ThreadId": "389694",
    "Html": "<p>Thanks for reply. When i tried the width setting i failed.</p>\r\n<p>I analized the xml code generated by script and saved by word. And the made this modification:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">protected</span> <span style=\"color: blue;\">function</span> _writeTable(PHPWord_Shared_XMLWriter $objWriter = null, PHPWord_Section_Table $table) {\r\n\t\t$_rows = $table-&gt;getRows();\r\n\t\t$_cRows = count($_rows);\r\n\t\t\r\n\t\t<span style=\"color: blue;\">if</span>($_cRows &gt; 0) {\r\n\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:tbl'</span>);\r\n\t\t\t\t$tblStyle = $table-&gt;getStyle();\r\n\t\t\t\t<span style=\"color: blue;\">if</span>($tblStyle <span style=\"color: blue;\">instanceof</span> PHPWord_Style_Table) {\r\n\t\t\t\t\t$this-&gt;_writeTableStyle($objWriter, $tblStyle);\r\n\t\t\t\t} <span style=\"color: blue;\">else</span> {\r\n\t\t\t\t\t<span style=\"color: blue;\">if</span>(!<span style=\"color: blue;\">empty</span>($tblStyle)) {\r\n\t\t\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:tblPr'</span>);\r\n\t\t\t\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:tblStyle'</span>);\r\n\t\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:val'</span>, $tblStyle);\r\n\t\t\t\t\t\t\t$objWriter-&gt;endElement();\r\n\r\n<span style=\"color: green;\">// width part start //</span>\r\n\t\t\t\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:tblW'</span>);\r\n\t\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:w'</span>, <span style=\"color: #a31515;\">'11350'</span>);\r\n\t\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:type'</span>, <span style=\"color: #a31515;\">'dxa'</span>);\r\n\t\t\t\t\t\t\t$objWriter-&gt;endElement();\r\n<span style=\"color: green;\">// width part end //</span>\r\n\t\t\t\t\t\t$objWriter-&gt;endElement();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n</pre>\r\n</div>\r\n<p>So i added tblW tag with a fixed (dxa) width. 11350 is about 100% width, while i'm using my personal margins.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2012-08-09T01:27:05.867-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]