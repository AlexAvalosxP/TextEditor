[
  {
    "Id": "1214163",
    "ThreadId": "535102",
    "Html": "Hi,\r<br />\nI am facing an issue in htmltodocx library as colspan of table not merging columns when it is opened in MS Word. The cell is being displayed broken without merge.\r<br />\n<br />\nI have implemented the below example :-\r<br />\n<a href=\"https://htmltodocx.codeplex.com/documentation\" rel=\"nofollow\">https://htmltodocx.codeplex.com/documentation</a>\r<br />\n<br />\nIts working properly in LibreOffice but not in MS Word.\r<br />\n<br />\nPlease let me know if anyone has solution for this.\r<br />\n<br />\nRegards,\r<br />\nVivek<br />\n",
    "PostedDate": "2014-02-24T20:15:01.997-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1247543",
    "ThreadId": "535102",
    "Html": "I have the same issue! Works well on OpenOffice too, but it doesn't on MS Word. Well I found a solution, it's not pretty but it's something:<br />\n<ol>\n<li>\nDo all the steps from the following link: <a href=\"http://stackoverflow.com/questions/11925337/how-to-merge-cells-in-phpword-or-to-have-different-number-of-cells-in-each-tabl\" rel=\"nofollow\">http://stackoverflow.com/questions/11925337/how-to-merge-cells-in-phpword-or-to-have-different-number-of-cells-in-each-tabl</a><br />\n</li>\n</ol>\nIn case the link expires here's the code: (It's not my code though, I got it from the link)<br />\n<pre><code>1 PHPWord/Section/Table/Cell.php\n    /**\n     * How many columns this cell spans\n     * @var int\n     */\n    private $_gridSpan;\n\n    public function__construct($insideOf,$pCount,$width=null,$style=null,$gridSpan=1){\n            $this-&gt;_insideOf = $insideOf;\n            ...\n            $this-&gt;_gridSpan = $gridSpan;\n    }\n\n    /**\n    * Get the number of columns this cell spans\n    *\n    * @return int\n    */\n    public function getGridSpan(){\n            return $this-&gt;_gridSpan;\n    }\n\n2 PHPWord/Section/Table.php\n     public function addCell($width,$style=null,$gridSpan=1){\n            $cell = new PHPWord_Section_Table_Cell($this-&gt;_insideOf,\n                    $this-&gt;_pCount,$width,$style,$gridSpan);\n      }\n\n    3 PHPWord/Writer/Word2007/Base.php\n\n      protected function _writeTable(PHPWord_Shared_XMLWriter $objWriter = null,            PHPWord_Section_Table $table) {\n                $_rows = $table-&gt;getRows();\n        $_cRows = count($_rows);\n                ...\n\n                    $_heights = $table-&gt;getRowHeights();\n            for($i=0; $i&lt;$_cRows; $i++) {\n               $row = $_rows[$i];\n               $height = $_heights[$i];\n                           //add\n                            $objWriter-&gt;startElement('w:trPr');\n                     //FIXME:Make this an option on a row or table\n                     $objWriter-&gt;startElement('w:cantSplit');\n                     $objWriter-&gt;endElement();\n                $objWriter-&gt;endElement();\n                           //end add\n                           foreach($rows as $cell){\n\n                                  ...\n                                  $width = $cell-&gt;getWidth();\n                                  //add \n                                  $gridSpan = $cell-&gt;getGridSpan();\n                                  //end add\n                                   ...\n                                  //add\n                                  if($gridSpan &gt; 1){\n                                      $objWriter-&gt;startElement('w:gridSpan');\n                                          $objWriter-&gt;writeAttribute('w:val',$gridSpan);\n                                      $objWriter-&gt;endElement();\n                                   }\n                                  //end add\n                             ...\n                                  }\n                           }          \n}\n</code></pre>\n\n<ol>\n<li>\nAfter you're done with that, you need to modify htmltodocx_converter/h2d_htmlconverter.php<br />\n</li>\n</ol>\n<pre><code>function htmltodocx_insert_html_recursive(&amp;$phpword_element, $html_dom_array, &amp;$state = array()) {\n ....\n  case 'table':\n  ...\n  //replace this line:\n   if (is_object($state['phpword_object']) &amp;&amp; method_exists($state['phpword_object'], 'addTableStyle')) {\n              $state['phpword_object']-&gt;addTableStyle('temp_table_style', $state['current_style']);\n              $table_style = 'temp_table_style';\n            }\n  // with this:\n if (is_object($state['phpword_object']) &amp;&amp; method_exists($state['phpword_object'], 'addTableStyle')) {\n              $state['phpword_object']-&gt;addTableStyle('temp_table_style', $state['current_style'], null);\n              $table_style = 'temp_table_style';\n            }\n  //notice the 'NULL' added\n\n  ...\n  case 'td':\n  case 'th':\n  ...\n   //replace this line:\n  $state['table_cell'] = $state['table']-&gt;addCell($cell_width, $state['current_style']);\n\n   //with this:\n  $state['table_cell'] = $state['table']-&gt;addCell($cell_width, $state['current_style'], $element-&gt;colspan);</code></pre>\n\nAnd that's it. I tested it and worked great for me. Hope it's any help!<br />\n",
    "PostedDate": "2014-05-20T10:58:27.443-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]